Using TensorFlow backend.
Collecting training images...
Training images collected in .. 0.744166135788
Collecting testing images...
Testing images collected in .. 0.225548028946
Initialising ResNet-101 !
Model defined in .. 62.7799701691
Compiling model with nesterov momentum ..
Compiled in .. 4.23011112213
Normalizing data...
Training on batch...
Epoch 1/3
237/237 [==============================] - 1232s - loss: 10.2823 - acc: 0.0506         
Epoch 2/3
237/237 [==============================] - 1214s - loss: 10.6210 - acc: 0.0633    
Epoch 3/3
237/237 [==============================] - 1199s - loss: 11.0500 - acc: 0.0759         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 150s     
[10.894143657919802, 0.024691358024691357]
[[ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.00691081  0.02581136  0.09121756 ...,  0.19877113  0.04311706
   0.03052719]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[13 13 13 13 13 13 18 18 18 18 18 13 13 13 13 13 13 13 13 13 13 13 13 13 13
 18 13 13 13 13 13 13 18  9 18 18 18 18 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 13 18 18 18 13 13 13 13 13 13 13 13 18 18 18 18 18 18 18 13 13
 13 13 18 18 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 415.149688959
Epoch 1/3
237/237 [==============================] - 1199s - loss: 10.6284 - acc: 0.0717        
Epoch 2/3
237/237 [==============================] - 1182s - loss: 12.2288 - acc: 0.0506     
Epoch 3/3
237/237 [==============================] - 1188s - loss: 11.7563 - acc: 0.0380    
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[16.118095397949219, 0.0]
[[ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
[13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13
 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13
 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13
 13 13 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 293.417103052
Epoch 1/3
237/237 [==============================] - 1189s - loss: 12.7974 - acc: 0.0295         
Epoch 2/3
237/237 [==============================] - 1192s - loss: 12.2922 - acc: 0.0422         
Epoch 3/3
237/237 [==============================] - 1194s - loss: 11.4065 - acc: 0.0591        
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[9.5500395033094616, 0.07407407407407407]
[[ 0.00752447  0.03447363  0.13727655 ...,  0.10474303  0.0302051
   0.02443318]
 [ 0.00752447  0.03447363  0.13727655 ...,  0.10474303  0.0302051
   0.02443318]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[ 2  2 13  9 13 13  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2 13 13 13
 13  2  2  2  2  2  2 13 13 13 13 13  9  2  2  2  2  2 13 13 13 13 13 13 13
 13 13 13 13 13 13 13 13 13 13  2  2 13 13 13 13  2  2  2 13 13 13  2  2  2
  2 13 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.777981997
Epoch 1/3
237/237 [==============================] - 1161s - loss: 10.7913 - acc: 0.0464         
Epoch 2/3
237/237 [==============================] - 1160s - loss: 10.7363 - acc: 0.0591         
Epoch 3/3
237/237 [==============================] - 1169s - loss: 10.5905 - acc: 0.0506         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[9.300000037676023, 0.024691358024691357]
[[ 0.00990978  0.03712932  0.1063647  ...,  0.13034357  0.02667245
   0.0202849 ]
 [ 0.00990978  0.03712932  0.1063647  ...,  0.13034357  0.02667245
   0.0202849 ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[18 18 13 18 13 13 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 13 13 13
 13 18 18 18 18 18 18 13 13 13 13 13 18 18 18 18 18 18 13 13 13 13 13 13 13
 13 13 13 13 13 13 13 13 18 18 18 18 13 13 13 13 18 18 13 13 13 13 18 18 18
 18 13 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 293.325870037
Epoch 1/3
237/237 [==============================] - 1182s - loss: 10.6113 - acc: 0.0464     
Epoch 2/3
237/237 [==============================] - 1187s - loss: 9.7042 - acc: 0.0464          
Epoch 3/3
237/237 [==============================] - 1189s - loss: 11.2578 - acc: 0.0464         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[11.279610433696229, 0.024691358024691357]
[[ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.0237847   0.04398433  0.09718099 ...,  0.11305645  0.02575895
   0.01795311]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[13  9 13 13 13 13 10 10 10 10 10 10 10 10 10  9 13  9 13 13  9 13 13 13 13
 13 13 13  9 13  9  9 13 13 13 13 13 13 10 10 10 10 18 10 13 10 13 13 13 13
 13 13 13 13 13 13 13 13 13  9 10 10 13 13 13 13 10 10 13 13 13 13 10 10  9
 10 13 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.503093958
Epoch 1/3
237/237 [==============================] - 1190s - loss: 11.8721 - acc: 0.0464         
Epoch 2/3
237/237 [==============================] - 1192s - loss: 11.5600 - acc: 0.0886     
Epoch 3/3
237/237 [==============================] - 1198s - loss: 11.5672 - acc: 0.0464         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[9.9100892808702259, 0.024691358024691357]
[[ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.02343433  0.05040465  0.0927959  ...,  0.14745836  0.02514777
   0.02120567]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[13 18 13 13 13 13 18 18 18 18 18 18 18 18 18 18 18 18 18  9 18 18 13 13 13
 13 13 13 18 13  9 18 13 13 13 13 13 13 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 18 18 18 18 13 13 13 13 18 18 13 13 13 13 18 18 13
  0 18 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.604021072
Epoch 1/3
237/237 [==============================] - 1177s - loss: 10.8596 - acc: 0.0506         
Epoch 2/3
237/237 [==============================] - 1182s - loss: 11.1720 - acc: 0.0506         
Epoch 3/3
237/237 [==============================] - 1184s - loss: 11.2095 - acc: 0.0591         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[9.2126326384367765, 0.037037037037037035]
[[ 0.01543748  0.05509131  0.09164453 ...,  0.138234    0.02586011
   0.02472422]
 [ 0.01543748  0.05509131  0.09164453 ...,  0.138234    0.02586011
   0.02472422]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 ..., 
 [ 0.01543748  0.05509131  0.09164453 ...,  0.138234    0.02586011
   0.02472422]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]
 [ 0.          0.          0.         ...,  0.          0.          0.        ]]
[18 18 13 13 13 13 18 18 18 18 18 18 18 18 18 18 18 18 18 18  9 18 13 13 13
 13 13 13 18 13 18 18 13 13 13 13 13  9 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 18 18 18 18 13 18 13 13 18 18 18 13 13  9 18 18 13
 13 18 13 18 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.082476139
Epoch 1/3
237/237 [==============================] - 1185s - loss: 11.5717 - acc: 0.0506     
Epoch 2/3
237/237 [==============================] - 1194s - loss: 10.8904 - acc: 0.0759     
Epoch 3/3
237/237 [==============================] - 1198s - loss: 12.3397 - acc: 0.0506         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[11.673934088812935, 0.024691358024691357]
[[ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
[13 13 13 13 13 13 18 18 18 18 18 18 18 18 18 13 13 13 13 13 13 13 13 13 13
 18 13 13 13 13 13 13 13 13 13 13 13 13 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 13 13 13 13 13 18 13 13 18 18 18 13 13 18 18 13 13
 13 18 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.525640965
Epoch 1/3
237/237 [==============================] - 1193s - loss: 11.9478 - acc: 0.0549     
Epoch 2/3
237/237 [==============================] - 1195s - loss: 11.9433 - acc: 0.0422         
Epoch 3/3
237/237 [==============================] - 1198s - loss: 11.6034 - acc: 0.0506         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[12.018738075538918, 0.024691358024691357]
[[ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 ..., 
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]
 [ 0.  0.  0. ...,  0.  0.  0.]]
[13 13 13 13 13 13 18 18 18 18 18 18 18 18 18 13 13 13 13 13 13 13 13 13 13
 13 13 13 13 13 13 13 13 13 13 13 13 13 13 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 13 13 13 13 13 18 18 18 18 18 18 13 13 13 18 13 13
 13 18 13 13 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.751418114
Epoch 1/3
237/237 [==============================] - 1177s - loss: 11.3329 - acc: 0.0675        
Epoch 2/3
237/237 [==============================] - 1190s - loss: 10.8980 - acc: 0.0717         
Epoch 3/3
237/237 [==============================] - 1190s - loss: 11.5063 - acc: 0.0675         
Evaluating, predicting and saving weights ..
81/81 [==============================] - 145s     
[9.9916038984133877, 0.024691358024691357]
[[  1.57965459e-02   6.25273138e-02   7.96029717e-02 ...,   1.52438477e-01
    2.93092187e-02   3.42013724e-02]
 [  9.32019018e-03   3.88029759e-04   3.93048394e-04 ...,   2.82744259e-01
    1.26134648e-04   1.91907471e-04]
 [  2.27304660e-02   6.28949404e-02   7.87800178e-02 ...,   1.53050780e-01
    2.91517060e-02   3.40273343e-02]
 ..., 
 [  1.57965459e-02   6.25273138e-02   7.96029717e-02 ...,   1.52438477e-01
    2.93092187e-02   3.42013724e-02]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]]
[18 13 18 13 13 18 18 18 18 18 18 18 18 18 18 13 13 13 13 13 13 13 13 13 13
 18 13 13 13 13 13 13 13 13 13 13 13 18 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 13 18 18 18 13 18 13 18 18 18 18 13 13 18 18 18 13
 13 18 18 18 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 292.792002916
Total training time .. 39178.0732532
Evaluating, predicting and saving weights ..
81/81 [==============================] - 156s     
[9.9916037806758169, 0.024691358024691357]
[[  1.57965459e-02   6.25273138e-02   7.96029717e-02 ...,   1.52438477e-01
    2.93092187e-02   3.42013724e-02]
 [  9.32019018e-03   3.88029759e-04   3.93048394e-04 ...,   2.82744259e-01
    1.26134648e-04   1.91907471e-04]
 [  2.27304660e-02   6.28949404e-02   7.87800178e-02 ...,   1.53050780e-01
    2.91517060e-02   3.40273343e-02]
 ..., 
 [  1.57965459e-02   6.25273138e-02   7.96029717e-02 ...,   1.52438477e-01
    2.93092187e-02   3.42013724e-02]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]]
[18 13 18 13 13 18 18 18 18 18 18 18 18 18 18 13 13 13 13 13 13 13 13 13 13
 18 13 13 13 13 13 13 13 13 13 13 13 18 18 18 18 18 18 18 13 18 13 13 13 13
 13 13 13 13 18 13 13 13 13 18 18 18 13 18 13 18 18 18 18 13 13 18 18 18 13
 13 18 18 18 13 13]
[ 0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  4  4  4  4  4  4  4  5  5  6
  6  7  7  7  7  7  7  8  8  8  8  9  9  9  9  9  9 10 10 10 10 11 11 11 11
 11 12 12 12 15 15 15 15 16 16 16 16 20 20 20 20 18 18 19 19 17 17 17 16 16
 16 15 15 15 14 14]
Evaluated, predicted and saved weights ! All done in .. 315.470746994